#setwd("/Users/caprinapugliese/Documents/School/Uconn/2024-26_Grad_School/2025-26_Year-2/popgen/labs/cappys_labs_popgen25/cappy_short_assignment")
source("cappy_short_assign_src.R")

og_GT <- read.csv("25_10-09_short_assign_fake_data_w_NAs.csv")
samples <- read.csv("25_10-09_short_assign_pop-file.csv")

#GT_no_NAs <- read.table("25_10-09_short_assign_fake-data.txt")
# ^^for debugging in case there's an NA issue

#individual sites
freq_GT(og_GT$X1)
# [1] 0.3
sample_het(og_GT$X1)
# [1] 0.4307692

# reworked the data to get function to work
tGT <- as.data.frame(t(og_GT))
GT <- tGT |> dplyr::slice(2:41) |> setNames(og_GT$indivs)
GT <- as.data.frame(apply(GT, 2, function(x) as.numeric(as.character(x))))

process_GT(GT, samples)
# output:
#$`obs alleles`
#$`obs alleles`$POP1
# [1] 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5

#$`obs alleles`$POP2
# [1] 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5

#$`obs alleles`$POP3
# [1] 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5

#$`obs alleles`$POP4
# [1] 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5


#$`allele freqs`
#$`allele freqs`$POP1
# [1] 0.4 0.8 1.0 0.2 0.4 0.6 0.2 0.4 0.6 0.2 0.4 0.6 0.6 0.6 0.4 0.6 0.6 0.6 0.0 1.0 0.2 0.4 0.2
#[24] 0.6 0.2 0.6 0.2 0.4 0.8 0.4 0.2 0.8 0.2 0.8 0.2 0.8 0.2 0.4 0.8 0.4

#$`allele freqs`$POP2
# [1] 0.4 0.2 0.4 0.2 0.6 0.6 0.0 0.2 0.2 0.2 0.4 0.4 0.2 0.2 0.4 0.0 0.4 0.6 1.0 0.2 0.2 0.6 0.2
#[24] 0.6 0.2 0.6 0.6 0.4 0.4 0.4 0.8 0.6 0.8 0.4 0.2 0.6 0.6 0.8 0.6 0.6

#$`allele freqs`$POP3
# [1] 0.2 0.6 0.8 0.6 0.0 0.8 0.6 0.8 0.8 0.2 0.6 0.4 0.4 0.2 0.2 1.0 0.2 0.2 0.4 0.4 0.4 0.4 0.4
#[24] 0.4 0.4 0.6 0.0 0.4 0.2 0.4 0.6 0.2 0.4 0.6 0.6 0.2 0.8 0.8 0.2 0.4

#$`allele freqs`$POP4
# [1] 0.2 0.4 0.6 0.2 0.8 0.4 0.4 0.2 0.6 0.4 0.2 0.2 0.6 0.4 1.0 0.4 0.4 0.8 0.6 0.8 0.4 0.2 0.4
#[24] 0.0 0.6 0.0 0.0 0.2 0.2 0.6 0.8 0.4 0.4 0.4 0.2 0.4 0.2 0.4 0.4 0.6


#$heterozygosities
#$heterozygosities$POP1
# [1] 0.5333333 0.3555556 0.0000000 0.3555556 0.5333333 0.5333333 0.3555556 0.5333333 0.5333333
#[10] 0.3555556 0.5333333 0.5333333 0.5333333 0.5333333 0.5333333 0.5333333 0.5333333 0.5333333
#[19] 0.0000000 0.0000000 0.3555556 0.5333333 0.3555556 0.5333333 0.3555556 0.5333333 0.3555556
#[28] 0.5333333 0.3555556 0.5333333 0.3555556 0.3555556 0.3555556 0.3555556 0.3555556 0.3555556
#[37] 0.3555556 0.5333333 0.3555556 0.5333333

#$heterozygosities$POP2
# [1] 0.5333333 0.3555556 0.5333333 0.3555556 0.5333333 0.5333333 0.0000000 0.3555556 0.3555556
#[10] 0.3555556 0.5333333 0.5333333 0.3555556 0.3555556 0.5333333 0.0000000 0.5333333 0.5333333
#[19] 0.0000000 0.3555556 0.3555556 0.5333333 0.3555556 0.5333333 0.3555556 0.5333333 0.5333333
#[28] 0.5333333 0.5333333 0.5333333 0.3555556 0.5333333 0.3555556 0.5333333 0.3555556 0.5333333
#[37] 0.5333333 0.3555556 0.5333333 0.5333333

#$heterozygosities$POP3
# [1] 0.3555556 0.5333333 0.3555556 0.5333333 0.0000000 0.3555556 0.5333333 0.3555556 0.3555556
#[10] 0.3555556 0.5333333 0.5333333 0.5333333 0.3555556 0.3555556 0.0000000 0.3555556 0.3555556
#[19] 0.5333333 0.5333333 0.5333333 0.5333333 0.5333333 0.5333333 0.5333333 0.5333333 0.0000000
#[28] 0.5333333 0.3555556 0.5333333 0.5333333 0.3555556 0.5333333 0.5333333 0.5333333 0.3555556
#[37] 0.3555556 0.3555556 0.3555556 0.5333333

#$heterozygosities$POP4
# [1] 0.3555556 0.5333333 0.5333333 0.3555556 0.3555556 0.5333333 0.5333333 0.3555556 0.5333333
#[10] 0.5333333 0.3555556 0.3555556 0.5333333 0.5333333 0.0000000 0.5333333 0.5333333 0.3555556
#[19] 0.5333333 0.3555556 0.5333333 0.3555556 0.5333333 0.0000000 0.5333333 0.0000000 0.0000000
#[28] 0.3555556 0.3555556 0.5333333 0.3555556 0.5333333 0.5333333 0.5333333 0.3555556 0.5333333
#[37] 0.3555556 0.5333333 0.5333333 0.5333333


#$Fst
#$Fst$`POP1-POP2`
# [1] 0.4 0.2 0.4 0.2 0.6 0.6 0.0 0.2 0.2 0.2 0.4 0.4 0.2 0.2 0.4 0.0 0.4 0.6 1.0 0.2 0.2 0.6 0.2
#[24] 0.6 0.2 0.6 0.6 0.4 0.4 0.4 0.8 0.6 0.8 0.4 0.2 0.6 0.6 0.8 0.6 0.6

#$Fst$`POP1-POP3`
# [1] 0.2 0.6 0.8 0.6 0.0 0.8 0.6 0.8 0.8 0.2 0.6 0.4 0.4 0.2 0.2 1.0 0.2 0.2 0.4 0.4 0.4 0.4 0.4
#[24] 0.4 0.4 0.6 0.0 0.4 0.2 0.4 0.6 0.2 0.4 0.6 0.6 0.2 0.8 0.8 0.2 0.4

#$Fst$`POP1-POP4`
# [1] 0.2 0.4 0.6 0.2 0.8 0.4 0.4 0.2 0.6 0.4 0.2 0.2 0.6 0.4 1.0 0.4 0.4 0.8 0.6 0.8 0.4 0.2 0.4
#[24] 0.0 0.6 0.0 0.0 0.2 0.2 0.6 0.8 0.4 0.4 0.4 0.2 0.4 0.2 0.4 0.4 0.6

#$Fst$`POP2-POP3`
# [1] 0.2 0.6 0.8 0.6 0.0 0.8 0.6 0.8 0.8 0.2 0.6 0.4 0.4 0.2 0.2 1.0 0.2 0.2 0.4 0.4 0.4 0.4 0.4
#[24] 0.4 0.4 0.6 0.0 0.4 0.2 0.4 0.6 0.2 0.4 0.6 0.6 0.2 0.8 0.8 0.2 0.4

#$Fst$`POP2-POP4`
# [1] 0.2 0.4 0.6 0.2 0.8 0.4 0.4 0.2 0.6 0.4 0.2 0.2 0.6 0.4 1.0 0.4 0.4 0.8 0.6 0.8 0.4 0.2 0.4
#[24] 0.0 0.6 0.0 0.0 0.2 0.2 0.6 0.8 0.4 0.4 0.4 0.2 0.4 0.2 0.4 0.4 0.6

#$Fst$`POP3-POP4`
# [1] 0.2 0.4 0.6 0.2 0.8 0.4 0.4 0.2 0.6 0.4 0.2 0.2 0.6 0.4 1.0 0.4 0.4 0.8 0.6 0.8 0.4 0.2 0.4
#[24] 0.0 0.6 0.0 0.0 0.2 0.2 0.6 0.8 0.4 0.4 0.4 0.2 0.4 0.2 0.4 0.4 0.6


#$r2_means
 #     POP1       POP2       POP3       POP4 
#0.02481924 0.01711068 0.01655743 0.01370594